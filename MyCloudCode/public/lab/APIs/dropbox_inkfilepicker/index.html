<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
 
<head>
	<style>
		#holder { border: 10px dashed #ccc; width: 300px; height: 300px; margin: 20px auto;}
		#holder.hover { border: 10px dashed #333; }
	</style>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="f7evy1viv7t7i8v"></script>
	<script type="text/javascript" src="//api.filepicker.io/v1/filepicker.js"></script>
 
	
 
	


 
</head>
 
<body>
	<div id="holder"></div> 
	<div id="container"></div>
  	<p id="status">File API &amp; FileReader API not supported</p>
	<input id="clickMe" type="button" value="pick" onclick="pick();" />

	<script type="text/javascript">
		//https://www.inkfilepicker.com/
//https://developers.inkfilepicker.com/docs/web/
filepicker.setKey("AWp3P94AwTNOhRQA08Ccnz");

$('#clickMe').click(function (e) {
				
			
    

filepicker.pick({
    mimetypes: ['image/*', 'text/plain'],
    container: 'window',
    services:['COMPUTER', 'FACEBOOK', 'GMAIL','BOX','DROPBOX','EVERNOTE','FLICKR','GOOGLE_DRIVE','SKYDRIVE','PICASA'],
  },
  function(InkBlob){
    console.log(JSON.stringify(InkBlob));
  },
  function(FPError){
    console.log(FPError.toString());
  }
);
    
}),


//https://www.dropbox.com/developers/dropins/saver#demo
//http://html5demos.com/file-api

options = {

    // Required. Called when a user selects an item in the Chooser.
    success: function(files) {
        alert("Here's the file link: " + files[0].link)
        //location.href = "http://jtubert.parseapp.com/lab/APIs/dropbox_inkfilepicker/viewer.html?file="+files[0].link;
    },

    // Optional. Called when the user closes the dialog without selecting a file
    // and does not include any parameters.
    cancel: function() {

    },

    // Optional. "preview" (default) is a preview link to the document for sharing,
    // "direct" is an expiring link to download the contents of the file. For more
    // information about link types, see Link types below.
    linkType: "preview", // or "direct"

    // Optional. A value of false (default) limits selection to a single file, while
    // true enables multiple file selection.
    multiselect: false, // or true

    // Optional. This is a list of file extensions. If specified, the user will
    // only be able to select files with these extensions. You may also specify
    // file types, such as "video" or "images" in the list. For more information,
    // see File types below. By default, all extensions are allowed.
    extensions: ['.pdf', '.doc', '.docx'],
};

var button = Dropbox.createChooseButton(options);
document.getElementById("container").appendChild(button);

var holder = document.getElementById('holder'),
    state = document.getElementById('status');

if (typeof window.FileReader === 'undefined') {
  state.className = 'fail';
} else {
  state.className = 'success';
  state.innerHTML = 'File API & FileReader available';
}
 
holder.ondragover = function () { this.className = 'hover'; return false; };
holder.ondragend = function () { this.className = ''; return false; };
holder.ondrop = function (e) {
  this.className = '';
  e.preventDefault();

  var file = e.dataTransfer.files[0],
      reader = new FileReader();
  reader.onload = function (event) {
    console.log("t",event.target);
    holder.style.background = 'url(' + event.target.result + ') no-repeat center';
      var options = {
    files: [
        {'url': event.target.result, 'filename': file.name}
    ],

    // Success is called once all files have been successfully added to the user's
    // Dropbox, although they may not have synced to the user's devices yet.
    success: function () {
        console.log("success");
    },

    // Progress is called periodically to update the application on the progress
    // of the user's downloads. The value passed to this callback is a float
    // between 0 and 1. The progress callback is guaranteed to be called at least
    // once with the value 1.
    progress: function (progress) {},

    // Cancel is called if the user presses the Cancel button or closes the Saver.
    cancel: function () {},

    // Error is called in the event of an unexpected response from the server
    // hosting the files, such as not being able to find a file. This callback is
    // also called if there is an error on Dropbox or if the user is over quota.
    error: function (errorMessage) {}
};
var button = Dropbox.createSaveButton(options);
document.getElementById("container").appendChild(button);
  };
  console.log(file.name);
  reader.readAsDataURL(file);

  return false;
};
	</script>

	
</body>
</html>